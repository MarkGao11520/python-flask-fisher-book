# 10.1 最近的礼物

我们的首页会显示最近的赠送书籍列表。这个列表有三个限制条件：
1.数量不超过30
2.按照时间倒序排列，最新的排在最前面
3.去重，同一本书籍的礼物不重复出现

### 1.首先编写复杂SQL对应的ORM代码
由于是最近的礼物，所以应该编写在models/gift.py中
```python
    @classmethod
    def recent(cls):
        # 链式调用 主体是Query ，遇到all(),first()就会终止生成一条sql
        # 建造者模式
        # select distinct * from gift group by isbn order by create_time limit 30
        recent_gifts = Gift.query\
            .filter_by(launched=False)\
            .group_by(Gift.isbn)\
            .order_by(Gift.create_time)\
            .limit(30)\
            .distinct().all()
        return recent_gifts
```

为什么要定义成类方法呢。
- 对象代表一个礼物，是具体的
- 类代表礼物这个事物，他是抽象的，不是具体的一个