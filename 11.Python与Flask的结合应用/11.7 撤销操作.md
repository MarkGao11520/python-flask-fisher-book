# 11.7 撤销操作

### 1.更好的使用枚举
我们的数据库中pending存储的是数字类型，但是我们在代码中使用的是枚举类型。这肯定是匹配不上的，一种最优雅的解决方式就是为我们的Drift模型的pending属性编写getter/setter方法
```python
    # 状态
    _pending = Column('pending', SmallInteger, default=1)

    @property
    def pending(self):
        return PendingStatus(self._pending)

    @pending.setter
    def pending(self, status):
        self._pending = status.value
```
这样就能在外部使用枚举类型操作我们的属性了

### 2.撤销操作业务逻辑
```python
@web.route('/drift/<int:did>/redraw')
@login_required
def redraw_drift(did):
    with db.auto_commit()
        drift = Drift.query.get_or_404(did)
        # 使用枚举类型修改状态
        drift.pending = PendingStatus.Redraw
        # 将鱼豆还给用户
        current_user.beans += 1

    return redirect(url_for('web.pending'))
```